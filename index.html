<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>Qur'an Tracker – Hifdh & Mourājaʿa (Interactif)</title>
  <style>
    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      padding: 20px;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: #f3f3f7;
      color: #222;
    }

    .app-container {
      max-width: 900px;
      margin: 0 auto 40px auto;
    }

    h1 {
      text-align: center;
      margin-bottom: 0.5rem;
      font-weight: 600;
      letter-spacing: 0.05em;
      text-transform: uppercase;
      font-size: 1.1rem;
      color: #555;
    }

    .subtitle {
      text-align: center;
      font-size: 0.9rem;
      color: #777;
      margin-bottom: 2rem;
    }

    .toolbar {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      align-items: center;
      justify-content: center;
      margin-bottom: 24px;
    }

    .toolbar label {
      font-size: 0.9rem;
    }

    select {
      padding: 6px 10px;
      font-size: 0.95rem;
      border-radius: 6px;
      border: 1px solid #ccc;
      min-width: 220px;
    }

    .tracker-page {
      background: #ffffff;
      border-radius: 10px;
      padding: 28px 28px 36px 28px;
      box-shadow: 0 12px 30px rgba(0, 0, 0, 0.06);
      margin-bottom: 30px;
      page-break-after: always;
    }

    .header-ribbon {
      background: #6b4a7a;
      color: #fdfdfd;
      padding: 16px 20px 14px 20px;
      border-radius: 10px 10px 0 0;
      margin: -28px -28px 20px -28px;
    }

    .surah-ar {
      font-size: 1.6rem;
      direction: rtl;
      font-weight: 600;
      margin-bottom: 4px;
    }

    .surah-fr {
      font-size: 0.95rem;
      text-transform: uppercase;
      letter-spacing: 0.18em;
      color: #fdfdfd;
    }

    .meta {
      font-size: 0.8rem;
      color: #f0e9f8;
      margin-top: 4px;
    }

    .section-title {
      font-size: 0.9rem;
      text-transform: uppercase;
      letter-spacing: 0.2em;
      color: #666;
      margin: 10px 0 6px 0;
      text-align: center;
    }

    .section-subtitle {
      text-align: center;
      font-size: 0.8rem;
      color: #999;
      margin-bottom: 10px;
    }

    .grid-wrapper {
      border: 1px solid #e2d7ef;
      border-radius: 8px;
      padding: 10px;
      background: #faf8fd;
      margin-bottom: 18px;
    }

    table.ayah-grid {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.68rem;
      user-select: none;
    }

    .ayah-grid td {
      border: 1px solid #ded2ea;
      text-align: center;
      padding: 4px 0;
      min-width: 18px;
      height: 20px;
      cursor: pointer;
      transition: background 0.15s ease, color 0.15s ease, font-weight 0.15s ease;
    }

    .ayah-grid td.empty {
      background: #f2edf8;
      border: none;
      cursor: default;
    }

    /* État coché (verset marqué) */
    .ayah-grid td.state-on {
      background: #6b4a7a;
      color: #ffffff;
      font-weight: 600;
    }

    .footer-note {
      font-size: 0.72rem;
      color: #999;
      text-align: center;
      margin-top: 4px;
    }

    @media print {
      body {
        background: #ffffff;
        padding: 0;
      }
      .app-container {
        margin: 0;
        max-width: 100%;
      }
      .toolbar, h1, .subtitle {
        display: none;
      }
      .tracker-page {
        box-shadow: none;
        margin: 0;
        border-radius: 0;
      }
      .ayah-grid td {
        cursor: default;
      }
    }
  </style>
</head>
<body>
  <div class="app-container">
    <h1>TRACKER QURAN – HIFDH & MOURĀJAʿA (INTERACTIF)</h1>
    <div class="subtitle">
      Choisis une sourate puis clique sur les numéros de versets pour suivre ta mémorisation et ta révision. <br />
      La progression est sauvegardée dans ton navigateur (localement).
    </div>

    <div class="toolbar">
      <label for="surahSelect">Sourate :</label>
      <select id="surahSelect"></select>
    </div>

    <div id="pagesContainer">
      <!-- Les pages seront injectées ici en JavaScript -->
    </div>
  </div>

  <script>
    // Liste des sourates : numéro, nom latin, nom arabe, nombre de versets
    const SURAH_DATA = [
      { n: 1, latin: "Al-Fatiha", arabic: "الفاتحة", verses: 7 },
      { n: 2, latin: "Al-Baqara", arabic: "البقرة", verses: 286 },
      { n: 3, latin: "Aal Imran", arabic: "آل عمران", verses: 200 },
      { n: 4, latin: "An-Nisa", arabic: "النساء", verses: 176 },
      { n: 5, latin: "Al-Ma'idah", arabic: "المائدة", verses: 120 },
      { n: 6, latin: "Al-An'am", arabic: "الأنعام", verses: 165 },
      { n: 7, latin: "Al-A'raf", arabic: "الأعراف", verses: 206 },
      { n: 8, latin: "Al-Anfal", arabic: "الأنفال", verses: 75 },
      { n: 9, latin: "At-Tawbah", arabic: "التوبة", verses: 129 },
      { n: 10, latin: "Yunus", arabic: "يونس", verses: 109 },
      { n: 11, latin: "Hud", arabic: "هود", verses: 123 },
      { n: 12, latin: "Yusuf", arabic: "يوسف", verses: 111 },
      { n: 13, latin: "Ar-Ra'd", arabic: "الرعد", verses: 43 },
      { n: 14, latin: "Ibrahim", arabic: "إبراهيم", verses: 52 },
      { n: 15, latin: "Al-Hijr", arabic: "الحجر", verses: 99 },
      { n: 16, latin: "An-Nahl", arabic: "النحل", verses: 128 },
      { n: 17, latin: "Al-Isra", arabic: "الإسراء", verses: 111 },
      { n: 18, latin: "Al-Kahf", arabic: "الكهف", verses: 110 },
      { n: 19, latin: "Maryam", arabic: "مريم", verses: 98 },
      { n: 20, latin: "Ta-Ha", arabic: "طه", verses: 135 },
      { n: 21, latin: "Al-Anbiya", arabic: "الأنبياء", verses: 112 },
      { n: 22, latin: "Al-Hajj", arabic: "الحج", verses: 78 },
      { n: 23, latin: "Al-Mu'minun", arabic: "المؤمنون", verses: 118 },
      { n: 24, latin: "An-Nur", arabic: "النور", verses: 64 },
      { n: 25, latin: "Al-Furqan", arabic: "الفرقان", verses: 77 },
      { n: 26, latin: "Ash-Shu'ara", arabic: "الشعراء", verses: 227 },
      { n: 27, latin: "An-Naml", arabic: "النمل", verses: 93 },
      { n: 28, latin: "Al-Qasas", arabic: "القصص", verses: 88 },
      { n: 29, latin: "Al-Ankabut", arabic: "العنكبوت", verses: 69 },
      { n: 30, latin: "Ar-Rum", arabic: "الروم", verses: 60 },
      { n: 31, latin: "Luqman", arabic: "لقمان", verses: 34 },
      { n: 32, latin: "As-Sajda", arabic: "السجدة", verses: 30 },
      { n: 33, latin: "Al-Ahzab", arabic: "الأحزاب", verses: 73 },
      { n: 34, latin: "Saba", arabic: "سبأ", verses: 54 },
      { n: 35, latin: "Fatir", arabic: "فاطر", verses: 45 },
      { n: 36, latin: "Ya-Sin", arabic: "يس", verses: 83 },
      { n: 37, latin: "As-Saffat", arabic: "الصافات", verses: 182 },
      { n: 38, latin: "Sad", arabic: "ص", verses: 88 },
      { n: 39, latin: "Az-Zumar", arabic: "الزمر", verses: 75 },
      { n: 40, latin: "Ghafir", arabic: "غافر", verses: 85 },
      { n: 41, latin: "Fussilat", arabic: "فصلت", verses: 54 },
      { n: 42, latin: "Ash-Shura", arabic: "الشورى", verses: 53 },
      { n: 43, latin: "Az-Zukhruf", arabic: "الزخرف", verses: 89 },
      { n: 44, latin: "Ad-Dukhan", arabic: "الدخان", verses: 59 },
      { n: 45, latin: "Al-Jathiyah", arabic: "الجاثية", verses: 37 },
      { n: 46, latin: "Al-Ahqaf", arabic: "الأحقاف", verses: 35 },
      { n: 47, latin: "Muhammad", arabic: "محمد", verses: 38 },
      { n: 48, latin: "Al-Fath", arabic: "الفتح", verses: 29 },
      { n: 49, latin: "Al-Hujurat", arabic: "الحجرات", verses: 18 },
      { n: 50, latin: "Qaf", arabic: "ق", verses: 45 },
      { n: 51, latin: "Adh-Dhariyat", arabic: "الذاريات", verses: 60 },
      { n: 52, latin: "At-Tur", arabic: "الطور", verses: 49 },
      { n: 53, latin: "An-Najm", arabic: "النجم", verses: 62 },
      { n: 54, latin: "Al-Qamar", arabic: "القمر", verses: 55 },
      { n: 55, latin: "Ar-Rahman", arabic: "الرحمن", verses: 78 },
      { n: 56, latin: "Al-Waqi'ah", arabic: "الواقعة", verses: 96 },
      { n: 57, latin: "Al-Hadid", arabic: "الحديد", verses: 29 },
      { n: 58, latin: "Al-Mujadila", arabic: "المجادلة", verses: 22 },
      { n: 59, latin: "Al-Hashr", arabic: "الحشر", verses: 24 },
      { n: 60, latin: "Al-Mumtahanah", arabic: "الممتحنة", verses: 13 },
      { n: 61, latin: "As-Saff", arabic: "الصف", verses: 14 },
      { n: 62, latin: "Al-Jumu'ah", arabic: "الجمعة", verses: 11 },
      { n: 63, latin: "Al-Munafiqun", arabic: "المنافقون", verses: 11 },
      { n: 64, latin: "At-Taghabun", arabic: "التغابن", verses: 18 },
      { n: 65, latin: "At-Talaq", arabic: "الطلاق", verses: 12 },
      { n: 66, latin: "At-Tahrim", arabic: "التحريم", verses: 12 },
      { n: 67, latin: "Al-Mulk", arabic: "الملك", verses: 30 },
      { n: 68, latin: "Al-Qalam", arabic: "القلم", verses: 52 },
      { n: 69, latin: "Al-Haqqah", arabic: "الحاقة", verses: 52 },
      { n: 70, latin: "Al-Ma'arij", arabic: "المعارج", verses: 44 },
      { n: 71, latin: "Nuh", arabic: "نوح", verses: 28 },
      { n: 72, latin: "Al-Jinn", arabic: "الجن", verses: 28 },
      { n: 73, latin: "Al-Muzzammil", arabic: "المزمل", verses: 20 },
      { n: 74, latin: "Al-Muddaththir", arabic: "المدثر", verses: 56 },
      { n: 75, latin: "Al-Qiyamah", arabic: "القيامة", verses: 40 },
      { n: 76, latin: "Al-Insan", arabic: "الإنسان", verses: 31 },
      { n: 77, latin: "Al-Mursalat", arabic: "المرسلات", verses: 50 },
      { n: 78, latin: "An-Naba", arabic: "النبأ", verses: 40 },
      { n: 79, latin: "An-Nazi'at", arabic: "النازعات", verses: 46 },
      { n: 80, latin: "Abasa", arabic: "عبس", verses: 42 },
      { n: 81, latin: "At-Takwir", arabic: "التكوير", verses: 29 },
      { n: 82, latin: "Al-Infitar", arabic: "الانفطار", verses: 19 },
      { n: 83, latin: "Al-Mutaffifin", arabic: "المطففين", verses: 36 },
      { n: 84, latin: "Al-Inshiqaq", arabic: "الانشقاق", verses: 25 },
      { n: 85, latin: "Al-Buruj", arabic: "البروج", verses: 22 },
      { n: 86, latin: "At-Tariq", arabic: "الطارق", verses: 17 },
      { n: 87, latin: "Al-A'la", arabic: "الأعلى", verses: 19 },
      { n: 88, latin: "Al-Ghashiyah", arabic: "الغاشية", verses: 26 },
      { n: 89, latin: "Al-Fajr", arabic: "الفجر", verses: 30 },
      { n: 90, latin: "Al-Balad", arabic: "البلد", verses: 20 },
      { n: 91, latin: "Ash-Shams", arabic: "الشمس", verses: 15 },
      { n: 92, latin: "Al-Layl", arabic: "الليل", verses: 21 },
      { n: 93, latin: "Ad-Duhaa", arabic: "الضحى", verses: 11 },
      { n: 94, latin: "Ash-Sharh", arabic: "الشرح", verses: 8 },
      { n: 95, latin: "At-Tin", arabic: "التين", verses: 8 },
      { n: 96, latin: "Al-Alaq", arabic: "العلق", verses: 19 },
      { n: 97, latin: "Al-Qadr", arabic: "القدر", verses: 5 },
      { n: 98, latin: "Al-Bayyinah", arabic: "البينة", verses: 8 },
      { n: 99, latin: "Az-Zalzalah", arabic: "الزلزلة", verses: 8 },
      { n: 100, latin: "Al-Adiyat", arabic: "العاديات", verses: 11 },
      { n: 101, latin: "Al-Qari'ah", arabic: "القارعة", verses: 11 },
      { n: 102, latin: "At-Takathur", arabic: "التكاثر", verses: 8 },
      { n: 103, latin: "Al-Asr", arabic: "العصر", verses: 3 },
      { n: 104, latin: "Al-Humazah", arabic: "الهمزة", verses: 9 },
      { n: 105, latin: "Al-Fil", arabic: "الفيل", verses: 5 },
      { n: 106, latin: "Quraysh", arabic: "قريش", verses: 4 },
      { n: 107, latin: "Al-Ma'un", arabic: "الماعون", verses: 7 },
      { n: 108, latin: "Al-Kawthar", arabic: "الكوثر", verses: 3 },
      { n: 109, latin: "Al-Kafirun", arabic: "الكافرون", verses: 6 },
      { n: 110, latin: "An-Nasr", arabic: "النصر", verses: 3 },
      { n: 111, latin: "Al-Masad", arabic: "المسد", verses: 5 },
      { n: 112, latin: "Al-Ikhlas", arabic: "الإخلاص", verses: 4 },
      { n: 113, latin: "Al-Falaq", arabic: "الفلق", verses: 5 },
      { n: 114, latin: "An-Nas", arabic: "الناس", verses: 6 }
    ];

    const COLS = 20; // colonnes dans la grille

    // Gestion clic sur une case
    function handleCellClick(e) {
      const td = e.currentTarget;
      if (td.classList.contains("empty")) return;

      const surah = td.dataset.surah;
      const mode = td.dataset.mode; // mem ou rev
      const verse = td.dataset.verse;

      const key = `qtracker_${surah}_${mode}_${verse}`;

      // Toggle visuel + stockage
      if (td.classList.contains("state-on")) {
        td.classList.remove("state-on");
        localStorage.removeItem(key);
      } else {
        td.classList.add("state-on");
        localStorage.setItem(key, "1");
      }
    }

    function buildGrid(verseCount, surahKey, mode) {
      const table = document.createElement("table");
      table.className = "ayah-grid";

      const tbody = document.createElement("tbody");

      let current = 1;
      while (current <= verseCount) {
        const tr = document.createElement("tr");
        for (let c = 0; c < COLS; c++) {
          const td = document.createElement("td");
          if (current <= verseCount) {
            td.textContent = current;
            td.dataset.surah = surahKey;
            td.dataset.mode = mode;
            td.dataset.verse = current;

            const key = `qtracker_${surahKey}_${mode}_${current}`;
            if (localStorage.getItem(key) === "1") {
              td.classList.add("state-on");
            }

            td.addEventListener("click", handleCellClick);
            current++;
          } else {
            td.className = "empty";
          }
          tr.appendChild(td);
        }
        tbody.appendChild(tr);
      }

      table.appendChild(tbody);
      return table;
    }

    function renderSurah(surahNumber) {
      const container = document.getElementById("pagesContainer");
      container.innerHTML = "";

      const surah = SURAH_DATA.find(s => s.n === surahNumber);
      if (!surah) return;

      const page = document.createElement("div");
      page.className = "tracker-page";

      const ribbon = document.createElement("div");
      ribbon.className = "header-ribbon";

      const arTitle = document.createElement("div");
      arTitle.className = "surah-ar";
      arTitle.textContent = "سورة " + surah.arabic;

      const frTitle = document.createElement("div");
      frTitle.className = "surah-fr";
      frTitle.textContent = surah.n + ". " + surah.latin;

      const meta = document.createElement("div");
      meta.className = "meta";
      meta.textContent = surah.verses + " versets";

      ribbon.appendChild(arTitle);
      ribbon.appendChild(frTitle);
      ribbon.appendChild(meta);

      page.appendChild(ribbon);

      // Mémorisation
      const memTitle = document.createElement("div");
      memTitle.className = "section-title";
      memTitle.textContent = "MÉMORISATION";

      const memSub = document.createElement("div");
      memSub.className = "section-subtitle";
      memSub.textContent = "Clique sur chaque verset mémorisé.";

      const memWrapper = document.createElement("div");
      memWrapper.className = "grid-wrapper";
      memWrapper.appendChild(buildGrid(surah.verses, `s${surah.n}`, "mem"));

      // Révision
      const revTitle = document.createElement("div");
      revTitle.className = "section-title";
      revTitle.textContent = "MOURĀJAʿA (RÉVISION)";

      const revSub = document.createElement("div");
      revSub.className = "section-subtitle";
      revSub.textContent = "Clique sur les versets révisés.";

      const revWrapper = document.createElement("div");
      revWrapper.className = "grid-wrapper";
      revWrapper.appendChild(buildGrid(surah.verses, `s${surah.n}`, "rev"));

      const foot = document.createElement("div");
      foot.className = "footer-note";
      foot.textContent = "Ce tracker t’aide à visualiser ta progression sans surcharge visuelle – uniquement des numéros de versets.";

      page.appendChild(memTitle);
      page.appendChild(memSub);
      page.appendChild(memWrapper);
      page.appendChild(revTitle);
      page.appendChild(revSub);
      page.appendChild(revWrapper);
      page.appendChild(foot);

      container.appendChild(page);
    }

    function init() {
      const select = document.getElementById("surahSelect");

      SURAH_DATA.forEach(s => {
        const opt = document.createElement("option");
        opt.value = s.n;
        opt.textContent = s.n + " – " + s.latin;
        select.appendChild(opt);
      });

      select.addEventListener("change", () => {
        renderSurah(parseInt(select.value, 10));
      });

      // Par défaut : An-Naba (début Juz Amma)
      select.value = "78";
      renderSurah(78);
    }

    document.addEventListener("DOMContentLoaded", init);
  </script>
</body>
</html>


